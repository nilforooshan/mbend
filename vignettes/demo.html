<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mohammad Ali Nilforooshan" />

<meta name="date" content="2020-06-05" />

<title>Introduction to mbend</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to mbend</h1>
<h4 class="author">Mohammad Ali Nilforooshan</h4>
<h4 class="date">2020-06-05</h4>



<div id="introduction-to-mbend" class="section level1">
<h1>Introduction to mbend</h1>
<hr />
<div id="description" class="section level2">
<h2>Description</h2>
<p><em>Bending non-positive-definite (symmetric) matrices to positive-definite, using weighted and unweighted methods</em></p>
<p>The <code>mbend</code> package is used for bending symmetric non-positive-definite matrices to positive-definite (PD). For a matrix to be invertible, it has to be PD. The methods of Jorjani et al. (2003) and Schaeffer (2014) are used in this package. The unweighted method of Schaeffer (2014) is also extended to weighted bending, with the possibility of choosing between unweighted and weighted bending.</p>
</div>
<div id="application" class="section level2">
<h2>Application</h2>
<p>Start with loading the package library:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(mbend)</a></code></pre></div>
<p>Consider the following non-PD covariance matrix (Jorjani et al., 2003):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">V =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">ncol=</span><span class="dv">5</span>, <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="dv">100</span>,  <span class="dv">95</span>,  <span class="dv">80</span>,  <span class="dv">40</span>,  <span class="dv">40</span>,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">   <span class="dv">95</span>, <span class="dv">100</span>,  <span class="dv">95</span>,  <span class="dv">80</span>,  <span class="dv">40</span>,</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">   <span class="dv">80</span>,  <span class="dv">95</span>, <span class="dv">100</span>,  <span class="dv">95</span>,  <span class="dv">80</span>,</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">   <span class="dv">40</span>,  <span class="dv">80</span>,  <span class="dv">95</span>, <span class="dv">100</span>,  <span class="dv">95</span>,</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">   <span class="dv">40</span>,  <span class="dv">40</span>,  <span class="dv">80</span>,  <span class="dv">95</span>, <span class="dv">100</span>))</a></code></pre></div>
<p>The following command can be used to bend matrix <code>V</code> to a PD matrix:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">bend</span>(V)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; Unweighted bending</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; max.iter = 10000</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; small.positive = 1e-04</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; method = hj</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; Convergence met after 1 iterations.</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; $bent</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; [1,] 103.16918  90.83313  79.47122  44.53731  37.07254</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; [2,]  90.83313 106.49734  94.18961  74.07039  44.53731</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; [3,]  79.47122  94.18961 102.31355  94.18961  79.47122</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; [4,]  44.53731  74.07039  94.18961 106.49734  90.83313</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; [5,]  37.07254  44.53731  79.47122  90.83313 103.16918</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; $init.ev</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; [1] 399.475997  98.523500  23.646897  -3.122893 -18.523500</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt; $final.ev</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt; [1] 399.4760  98.5235  23.6469   0.0001   0.0001</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; $min.dev</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt; [1] -5.929612</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; $max.dev</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; [1] 6.497343</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt; $loc.min.dev</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt;   2   4 </span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt; $loc.max.dev</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt;   4   4 </span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">#&gt; $ave.dev</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">#&gt; [1] 0.7234705</span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="co">#&gt; $AAD</span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="co">#&gt; [1] 3.372692</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"><span class="co">#&gt; $Cor</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"><span class="co">#&gt; [1] 0.985632</span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-44" data-line-number="44"><span class="co">#&gt; $RMSD</span></a>
<a class="sourceLine" id="cb3-45" data-line-number="45"><span class="co">#&gt; [1] 3.927457</span></a></code></pre></div>
<p>The above command is equivalent to <code>bend(inmat=V)</code>, where <code>inmat</code> is the argument that takes the matrix to be bent, or the following command:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">bend</span>(V, <span class="dt">max.iter=</span><span class="dv">10000</span>, <span class="dt">small.positive=</span><span class="fl">0.0001</span>, <span class="dt">method=</span><span class="st">&quot;hj&quot;</span>)</a></code></pre></div>
<p>This runs the unweighted bending method of Jorjani et al. (2003) (<code>method=&quot;hj&quot;</code>), with maximum 10000 number of iterations (<code>max.iter=10000</code>), and eigenvalues smaller than 0.0001 are replaced with this small positive value (<code>small.positive=0.0001</code>). Providing the default parameters, the corresponding arguments can be omitted (e.g., <code>bend(V)</code>).</p>
<p>The output object is a list of several items, listed below:</p>
<ul>
<li>bent : The bent <code>matrix</code>.</li>
<li>init.ev : Eigenvalues of the initial (<code>inmat</code>) matrix.</li>
<li>final.ev : Eigenvalues of the <code>bent</code> matrix.</li>
<li>min.dev : <code>min(bent - inmat)</code>.</li>
<li>max.dev : <code>max(bent - inmat)</code>.</li>
<li>loc.min.dev : Location (indices) of <code>min.dev</code> element.</li>
<li>loc.max.dev : Location (indices) of <code>max.dev</code> element.</li>
<li>ave.dev : Average deviation (<code>bent - inmat</code>) of the upper triangle elements (excluding diagonal elements for correlation matrices).</li>
<li>AAD : Average absolute deviation of the upper triangle elements (excluding diagonal elements for correlation matrices) of <code>bent</code> and <code>inmat</code>.</li>
<li>Cor : Correlation between the upper triangle elements (excluding diagonal elements for correlation matrices) of <code>bent</code> and <code>inmat</code>.</li>
<li>RMSD : Root of mean squared deviation of the upper triangle elements (excluding diagonal elements for correlation matrices) of <code>bent</code> and <code>inmat</code>.</li>
</ul>
<p>There might be different precision involved with different elements of a non-PD matrix. In this case, a weighted bending is recommended. Jorjani et al. (2003) used the reciprocal of the number data points in common between pairs of variables, as weights. Considering the following matrix for the number of data points in common between variables (Jorjani et al., 2003):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">W =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">ncol=</span><span class="dv">5</span>, <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  <span class="dv">1000</span>,  <span class="dv">500</span>,   <span class="dv">20</span>,   <span class="dv">50</span>,  <span class="dv">200</span>,</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">   <span class="dv">500</span>, <span class="dv">1000</span>,  <span class="dv">500</span>,    <span class="dv">5</span>,   <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">    <span class="dv">20</span>,  <span class="dv">500</span>, <span class="dv">1000</span>,   <span class="dv">20</span>,   <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">    <span class="dv">50</span>,    <span class="dv">5</span>,   <span class="dv">20</span>, <span class="dv">1000</span>,  <span class="dv">200</span>,</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">   <span class="dv">200</span>,   <span class="dv">50</span>,   <span class="dv">20</span>,  <span class="dv">200</span>, <span class="dv">1000</span>))</a></code></pre></div>
<p>Matrix <code>V</code> is bent using the following command:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">bend</span>(<span class="dt">inmat=</span>V, <span class="dt">wtmat=</span>W, <span class="dt">reciprocal=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; Weighted bending</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; reciprocal = TRUE</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; max.iter = 10000</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; small.positive = 1e-04</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; method = hj</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; Convergence met after 428 iterations.</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; $bent</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; [1,] 100.16154  94.51747  82.93843  43.56681  39.18292</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; [2,]  94.51747 100.62488  93.98150  59.99921  45.84555</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; [3,]  82.93843  93.98150 100.69547  84.89294  73.13431</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; [4,]  43.56681  59.99921  84.89294 100.30697  94.23170</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; [5,]  39.18292  45.84555  73.13431  94.23170 100.17942</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; $init.ev</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; [1] 399.475997  98.523500  23.646897  -3.122893 -18.523500</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; $final.ev</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; [1] 3.876377e+02 1.020313e+02 1.229913e+01 7.667873e-05 1.210388e-06</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; $min.dev</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; [1] -20.00079</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt; $max.dev</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt; [1] 5.84555</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt; $loc.min.dev</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt;   2   4 </span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt; $loc.max.dev</span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt;   2   5 </span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">#&gt; $ave.dev</span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt; [1] -1.716058</span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="co">#&gt; $AAD</span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="co">#&gt; [1] 3.625268</span></a>
<a class="sourceLine" id="cb6-41" data-line-number="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-42" data-line-number="42"><span class="co">#&gt; $Cor</span></a>
<a class="sourceLine" id="cb6-43" data-line-number="43"><span class="co">#&gt; [1] 0.9623206</span></a>
<a class="sourceLine" id="cb6-44" data-line-number="44"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-45" data-line-number="45"><span class="co">#&gt; $RMSD</span></a>
<a class="sourceLine" id="cb6-46" data-line-number="46"><span class="co">#&gt; [1] 6.368693</span></a>
<a class="sourceLine" id="cb6-47" data-line-number="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-48" data-line-number="48"><span class="co">#&gt; $w_gt_0</span></a>
<a class="sourceLine" id="cb6-49" data-line-number="49"><span class="co">#&gt; [1] 15</span></a>
<a class="sourceLine" id="cb6-50" data-line-number="50"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-51" data-line-number="51"><span class="co">#&gt; $wAAD</span></a>
<a class="sourceLine" id="cb6-52" data-line-number="52"><span class="co">#&gt; [1] 0.6100103</span></a>
<a class="sourceLine" id="cb6-53" data-line-number="53"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-54" data-line-number="54"><span class="co">#&gt; $wCor</span></a>
<a class="sourceLine" id="cb6-55" data-line-number="55"><span class="co">#&gt; [1] 0.9955121</span></a>
<a class="sourceLine" id="cb6-56" data-line-number="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-57" data-line-number="57"><span class="co">#&gt; $wRMSD</span></a>
<a class="sourceLine" id="cb6-58" data-line-number="58"><span class="co">#&gt; [1] 0.5326555</span></a></code></pre></div>
<p>Using <code>wtmat=1/W, reciprocal=FALSE</code>, the argument <code>reciprocal</code> could be omitted, because <code>FALSE</code> is the default parameter for the argument <code>reciprocal</code>. For the same reason, <code>max.iter=10000, small.positive=0.0001, method=&quot;hj&quot;</code> are omitted, unless different parameters are provided to these arguments.</p>
<p>If there is high confidence about some elements of the non-PD matrix to remain unchanged after bending, the corresponding weights are set to zero. For example, to keep the first 2 Ã— 2 block of <code>V</code> unchanged during the bending procedure:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">W2 =<span class="st"> </span>W; W2[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">bend</span>(V, W2, <span class="dt">reciprocal=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; Weighted bending</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; reciprocal = TRUE</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; max.iter = 10000</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; small.positive = 1e-04</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; method = hj</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; Convergence met after 475 iterations.</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; $bent</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; [1,] 100.00000  95.00000  83.70895  43.70489  39.12852</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; [2,]  95.00000 100.00000  93.89940  59.58422  46.15038</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; [3,]  83.70895  93.89940 100.73015  84.47456  72.91450</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; [4,]  43.70489  59.58422  84.47456 100.31566  94.21299</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; [5,]  39.12852  46.15038  72.91450  94.21299 100.18322</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; $init.ev</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt; [1] 399.475997  98.523500  23.646897  -3.122893 -18.523500</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt; $final.ev</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt; [1] 3.876582e+02 1.021544e+02 1.141629e+01 7.646818e-05 1.174802e-07</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; $min.dev</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt; [1] -20.41578</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt; $max.dev</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt; [1] 6.150379</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co">#&gt; $loc.min.dev</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt;   4   2 </span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"><span class="co">#&gt; $loc.max.dev</span></a>
<a class="sourceLine" id="cb7-34" data-line-number="34"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="co">#&gt;   2   5 </span></a>
<a class="sourceLine" id="cb7-36" data-line-number="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-37" data-line-number="37"><span class="co">#&gt; $ave.dev</span></a>
<a class="sourceLine" id="cb7-38" data-line-number="38"><span class="co">#&gt; [1] -1.732836</span></a>
<a class="sourceLine" id="cb7-39" data-line-number="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-40" data-line-number="40"><span class="co">#&gt; $AAD</span></a>
<a class="sourceLine" id="cb7-41" data-line-number="41"><span class="co">#&gt; [1] 3.705269</span></a>
<a class="sourceLine" id="cb7-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-43" data-line-number="43"><span class="co">#&gt; $Cor</span></a>
<a class="sourceLine" id="cb7-44" data-line-number="44"><span class="co">#&gt; [1] 0.9597991</span></a>
<a class="sourceLine" id="cb7-45" data-line-number="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-46" data-line-number="46"><span class="co">#&gt; $RMSD</span></a>
<a class="sourceLine" id="cb7-47" data-line-number="47"><span class="co">#&gt; [1] 6.564345</span></a>
<a class="sourceLine" id="cb7-48" data-line-number="48"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-49" data-line-number="49"><span class="co">#&gt; $w_gt_0</span></a>
<a class="sourceLine" id="cb7-50" data-line-number="50"><span class="co">#&gt; [1] 12</span></a>
<a class="sourceLine" id="cb7-51" data-line-number="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-52" data-line-number="52"><span class="co">#&gt; $wAAD</span></a>
<a class="sourceLine" id="cb7-53" data-line-number="53"><span class="co">#&gt; [1] 0.7705437</span></a>
<a class="sourceLine" id="cb7-54" data-line-number="54"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-55" data-line-number="55"><span class="co">#&gt; $wCor</span></a>
<a class="sourceLine" id="cb7-56" data-line-number="56"><span class="co">#&gt; [1] 0.9951209</span></a>
<a class="sourceLine" id="cb7-57" data-line-number="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-58" data-line-number="58"><span class="co">#&gt; $wRMSD</span></a>
<a class="sourceLine" id="cb7-59" data-line-number="59"><span class="co">#&gt; [1] 0.6080559</span></a></code></pre></div>
<p>For weighted bending, we get extra statistics in the output:</p>
<ul>
<li><code>w_gt_0</code> : Number of weight elements greater than 0, in the upper triangle of <code>wtmat</code> (for weighted bending).</li>
<li><code>wAAD</code> : Weighted <code>AAD</code> (for weighted bending).</li>
<li>wCor : Weighted <code>Cor</code> (for weighted bending).</li>
<li>wRMSD : Weighted <code>RMSD</code> (for weighted bending).</li>
</ul>
<p>To bend <code>V</code> using the method of Schaeffer (2014):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">bend</span>(<span class="dt">inmat=</span>V, <span class="dt">method=</span><span class="st">&quot;lrs&quot;</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt; Unweighted bending</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; max.iter = 10000</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; method = lrs</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; Convergence met after 1 iterations.</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; $bent</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; [1,] 103.18978  90.82704  79.43676  44.56754  37.06769</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; [2,]  90.82704 106.54177  94.13680  74.06295  44.56754</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; [3,]  79.43676  94.13680 102.46429  94.13680  79.43676</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; [4,]  44.56754  74.06295  94.13680 106.54177  90.82704</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; [5,]  37.06769  44.56754  79.43676  90.82704 103.18978</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; $init.ev</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; [1] 399.475997  98.523500  23.646897  -3.122893 -18.523500</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; $final.ev</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; [1] 399.47599653  98.52349955  23.64689694   0.20358328   0.07740478</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt; $min.dev</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt; [1] -5.937047</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt; $max.dev</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt; [1] 6.54177</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt; $loc.min.dev</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt;   4   2 </span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt; $loc.max.dev</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#&gt;   4   4 </span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt; $ave.dev</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt; [1] 0.732955</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt; $AAD</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">#&gt; [1] 3.408707</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt; $Cor</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt; [1] 0.9854511</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt; $RMSD</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#&gt; [1] 3.954199</span></a></code></pre></div>
<p>The method of Schaeffer (2014) does not require the argument <code>small.positive</code>, and this argument is ignored. This method is originally an unweighted bending method. However, in this package, it is extended to accommodate weighted bending (i.e., a combination of Schaeffer (2014) and Jorjani et al. (2003) methods). Weighted bending of <code>V</code> with reciprocals of <code>W</code> using the method of Schaeffer (2014):</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">bend</span>(V, W, <span class="dt">reciprocal=</span><span class="ot">TRUE</span>, <span class="dt">method=</span><span class="st">&quot;lrs&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; Weighted bending</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; reciprocal = TRUE</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; max.iter = 10000</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; method = lrs</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; Convergence met after 787 iterations.</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; $bent</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; [1,] 100.16194  94.51554  82.97457  43.57119  39.18071</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; [2,]  94.51554 100.62754  93.97669  60.00766  45.86380</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; [3,]  82.97457  93.97669 100.69806  84.86261  73.10529</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt; [4,]  43.57119  60.00766  84.86261 100.30785  94.22946</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt; [5,]  39.18071  45.86380  73.10529  94.22946 100.18003</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; $init.ev</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt; [1] 399.475997  98.523500  23.646897  -3.122893 -18.523500</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt; $final.ev</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt; [1] 3.876365e+02 1.020234e+02 1.228261e+01 3.242161e-02 4.435327e-04</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; $min.dev</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt; [1] -19.99234</span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#&gt; $max.dev</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">#&gt; [1] 5.863797</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co">#&gt; $loc.min.dev</span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="co">#&gt;   4   2 </span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="co">#&gt; $loc.max.dev</span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="co">#&gt;   5   2 </span></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35"><span class="co">#&gt; $ave.dev</span></a>
<a class="sourceLine" id="cb9-36" data-line-number="36"><span class="co">#&gt; [1] -1.715806</span></a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-38" data-line-number="38"><span class="co">#&gt; $AAD</span></a>
<a class="sourceLine" id="cb9-39" data-line-number="39"><span class="co">#&gt; [1] 3.633803</span></a>
<a class="sourceLine" id="cb9-40" data-line-number="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-41" data-line-number="41"><span class="co">#&gt; $Cor</span></a>
<a class="sourceLine" id="cb9-42" data-line-number="42"><span class="co">#&gt; [1] 0.9622401</span></a>
<a class="sourceLine" id="cb9-43" data-line-number="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-44" data-line-number="44"><span class="co">#&gt; $RMSD</span></a>
<a class="sourceLine" id="cb9-45" data-line-number="45"><span class="co">#&gt; [1] 6.374766</span></a>
<a class="sourceLine" id="cb9-46" data-line-number="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-47" data-line-number="47"><span class="co">#&gt; $w_gt_0</span></a>
<a class="sourceLine" id="cb9-48" data-line-number="48"><span class="co">#&gt; [1] 15</span></a>
<a class="sourceLine" id="cb9-49" data-line-number="49"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-50" data-line-number="50"><span class="co">#&gt; $wAAD</span></a>
<a class="sourceLine" id="cb9-51" data-line-number="51"><span class="co">#&gt; [1] 0.6122026</span></a>
<a class="sourceLine" id="cb9-52" data-line-number="52"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-53" data-line-number="53"><span class="co">#&gt; $wCor</span></a>
<a class="sourceLine" id="cb9-54" data-line-number="54"><span class="co">#&gt; [1] 0.9954884</span></a>
<a class="sourceLine" id="cb9-55" data-line-number="55"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-56" data-line-number="56"><span class="co">#&gt; $wRMSD</span></a>
<a class="sourceLine" id="cb9-57" data-line-number="57"><span class="co">#&gt; [1] 0.534688</span></a></code></pre></div>
<p>Function <code>bend</code> automatically considers any matrix with all diagonal elements equal to one, as a correlation matrix. Considering the correlation matrix <code>V2</code> (<code>V</code> converted to a correlation matrix):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">V2 =<span class="st"> </span><span class="kw">cov2cor</span>(V)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">bend</span>(V2, W, <span class="dt">reciprocal=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; Weighted bending</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; reciprocal = TRUE</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; max.iter = 10000</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; small.positive = 1e-04</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; method = hj</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; Found a correlation matrix.</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; Convergence met after 286 iterations.</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; $bent</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; [1,] 1.0000000 0.9447536 0.8342673 0.4377103 0.3912583</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt; [2,] 0.9447536 1.0000000 0.9385087 0.6004642 0.4630373</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt; [3,] 0.8342673 0.9385087 1.0000000 0.8394178 0.7248761</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; [4,] 0.4377103 0.6004642 0.8394178 1.0000000 0.9418815</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt; [5,] 0.3912583 0.4630373 0.7248761 0.9418815 1.0000000</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt; $init.ev</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; [1]  3.99475997  0.98523500  0.23646897 -0.03122893 -0.18523500</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; $final.ev</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt; [1] 3.868843e+00 1.015420e+00 1.156566e-01 7.740771e-05 2.031735e-06</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; $min.dev</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt; [1] -0.1995358</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt; $max.dev</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt; [1] 0.06303735</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">#&gt; $loc.min.dev</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">#&gt;   2   4 </span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">#&gt; $loc.max.dev</span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="co">#&gt;   5   2 </span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-38" data-line-number="38"><span class="co">#&gt; $ave.dev</span></a>
<a class="sourceLine" id="cb10-39" data-line-number="39"><span class="co">#&gt; [1] -0.02838248</span></a>
<a class="sourceLine" id="cb10-40" data-line-number="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-41" data-line-number="41"><span class="co">#&gt; $AAD</span></a>
<a class="sourceLine" id="cb10-42" data-line-number="42"><span class="co">#&gt; [1] 0.05538548</span></a>
<a class="sourceLine" id="cb10-43" data-line-number="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-44" data-line-number="44"><span class="co">#&gt; $Cor</span></a>
<a class="sourceLine" id="cb10-45" data-line-number="45"><span class="co">#&gt; [1] 0.9463128</span></a>
<a class="sourceLine" id="cb10-46" data-line-number="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-47" data-line-number="47"><span class="co">#&gt; $RMSD</span></a>
<a class="sourceLine" id="cb10-48" data-line-number="48"><span class="co">#&gt; [1] 0.0803483</span></a>
<a class="sourceLine" id="cb10-49" data-line-number="49"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-50" data-line-number="50"><span class="co">#&gt; $w_gt_0</span></a>
<a class="sourceLine" id="cb10-51" data-line-number="51"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb10-52" data-line-number="52"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-53" data-line-number="53"><span class="co">#&gt; $wAAD</span></a>
<a class="sourceLine" id="cb10-54" data-line-number="54"><span class="co">#&gt; [1] 0.01416959</span></a>
<a class="sourceLine" id="cb10-55" data-line-number="55"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-56" data-line-number="56"><span class="co">#&gt; $wCor</span></a>
<a class="sourceLine" id="cb10-57" data-line-number="57"><span class="co">#&gt; [1] 0.9942541</span></a>
<a class="sourceLine" id="cb10-58" data-line-number="58"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-59" data-line-number="59"><span class="co">#&gt; $wRMSD</span></a>
<a class="sourceLine" id="cb10-60" data-line-number="60"><span class="co">#&gt; [1] 0.01074558</span></a></code></pre></div>
<p>For correlation matrices, diagonal elements are not used in obtaining the statistics. Because the argument <code>method</code> is not provided, the default parameter <code>&quot;hj&quot;</code> is used. To do the same using the method of Schaeffer (2014):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">bend</span>(V2, W, <span class="dt">reciprocal=</span><span class="ot">TRUE</span>, <span class="dt">method=</span><span class="st">&quot;lrs&quot;</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; Weighted bending</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; reciprocal = TRUE</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; max.iter = 10000</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; method = lrs</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; Found a correlation matrix.</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; Convergence met after 700 iterations.</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; $bent</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; [1,] 1.0000000 0.9447383 0.8345316 0.4377385 0.3912447</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt; [2,] 0.9447383 1.0000000 0.9384618 0.6005923 0.4631893</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; [3,] 0.8345316 0.9384618 1.0000000 0.8392102 0.7245638</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; [4,] 0.4377385 0.6005923 0.8392102 1.0000000 0.9418734</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; [5,] 0.3912447 0.4631893 0.7245638 0.9418734 1.0000000</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; $init.ev</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; [1]  3.99475997  0.98523500  0.23646897 -0.03122893 -0.18523500</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">#&gt; $final.ev</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="co">#&gt; [1] 3.868820e+00 1.015338e+00 1.155776e-01 2.617687e-04 2.856950e-06</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="co">#&gt; $min.dev</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="co">#&gt; [1] -0.1994077</span></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="co">#&gt; $max.dev</span></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="co">#&gt; [1] 0.06318928</span></a>
<a class="sourceLine" id="cb11-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-28" data-line-number="28"><span class="co">#&gt; $loc.min.dev</span></a>
<a class="sourceLine" id="cb11-29" data-line-number="29"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb11-30" data-line-number="30"><span class="co">#&gt;   4   2 </span></a>
<a class="sourceLine" id="cb11-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-32" data-line-number="32"><span class="co">#&gt; $loc.max.dev</span></a>
<a class="sourceLine" id="cb11-33" data-line-number="33"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb11-34" data-line-number="34"><span class="co">#&gt;   5   2 </span></a>
<a class="sourceLine" id="cb11-35" data-line-number="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-36" data-line-number="36"><span class="co">#&gt; $ave.dev</span></a>
<a class="sourceLine" id="cb11-37" data-line-number="37"><span class="co">#&gt; [1] -0.02838562</span></a>
<a class="sourceLine" id="cb11-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-39" data-line-number="39"><span class="co">#&gt; $AAD</span></a>
<a class="sourceLine" id="cb11-40" data-line-number="40"><span class="co">#&gt; [1] 0.0554775</span></a>
<a class="sourceLine" id="cb11-41" data-line-number="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-42" data-line-number="42"><span class="co">#&gt; $Cor</span></a>
<a class="sourceLine" id="cb11-43" data-line-number="43"><span class="co">#&gt; [1] 0.946235</span></a>
<a class="sourceLine" id="cb11-44" data-line-number="44"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-45" data-line-number="45"><span class="co">#&gt; $RMSD</span></a>
<a class="sourceLine" id="cb11-46" data-line-number="46"><span class="co">#&gt; [1] 0.08039991</span></a>
<a class="sourceLine" id="cb11-47" data-line-number="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-48" data-line-number="48"><span class="co">#&gt; $w_gt_0</span></a>
<a class="sourceLine" id="cb11-49" data-line-number="49"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb11-50" data-line-number="50"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-51" data-line-number="51"><span class="co">#&gt; $wAAD</span></a>
<a class="sourceLine" id="cb11-52" data-line-number="52"><span class="co">#&gt; [1] 0.01420763</span></a>
<a class="sourceLine" id="cb11-53" data-line-number="53"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-54" data-line-number="54"><span class="co">#&gt; $wCor</span></a>
<a class="sourceLine" id="cb11-55" data-line-number="55"><span class="co">#&gt; [1] 0.9942327</span></a>
<a class="sourceLine" id="cb11-56" data-line-number="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-57" data-line-number="57"><span class="co">#&gt; $wRMSD</span></a>
<a class="sourceLine" id="cb11-58" data-line-number="58"><span class="co">#&gt; [1] 0.01077901</span></a></code></pre></div>
<p>Bending the same correlation matrix using the unweighted Schaeffer (2014):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">bend</span>(V2, <span class="dt">method=</span><span class="st">&quot;lrs&quot;</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; Unweighted bending</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; max.iter = 10000</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt; method = lrs</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; Found a correlation matrix.</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; Convergence met after 39 iterations.</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; $bent</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; [1,] 1.0000000 0.8935779 0.7794136 0.4716892 0.3599505</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; [2,] 0.8935779 1.0000000 0.9128285 0.7211811 0.4716892</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; [3,] 0.7794136 0.9128285 1.0000000 0.9128285 0.7794136</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; [4,] 0.4716892 0.7211811 0.9128285 1.0000000 0.8935779</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; [5,] 0.3599505 0.4716892 0.7794136 0.8935779 1.0000000</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt; $init.ev</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt; [1]  3.99475997  0.98523500  0.23646897 -0.03122893 -0.18523500</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co">#&gt; $final.ev</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt; [1] 3.9083638707 0.9183589993 0.1656638620 0.0071038704 0.0005093975</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt; $min.dev</span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt; [1] -0.07881887</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="co">#&gt; $max.dev</span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co">#&gt; [1] 0.07168916</span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="co">#&gt; $loc.min.dev</span></a>
<a class="sourceLine" id="cb12-28" data-line-number="28"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb12-29" data-line-number="29"><span class="co">#&gt;   4   2 </span></a>
<a class="sourceLine" id="cb12-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-31" data-line-number="31"><span class="co">#&gt; $loc.max.dev</span></a>
<a class="sourceLine" id="cb12-32" data-line-number="32"><span class="co">#&gt; row col </span></a>
<a class="sourceLine" id="cb12-33" data-line-number="33"><span class="co">#&gt;   5   2 </span></a>
<a class="sourceLine" id="cb12-34" data-line-number="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-35" data-line-number="35"><span class="co">#&gt; $ave.dev</span></a>
<a class="sourceLine" id="cb12-36" data-line-number="36"><span class="co">#&gt; [1] -0.02038503</span></a>
<a class="sourceLine" id="cb12-37" data-line-number="37"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-38" data-line-number="38"><span class="co">#&gt; $AAD</span></a>
<a class="sourceLine" id="cb12-39" data-line-number="39"><span class="co">#&gt; [1] 0.04906069</span></a>
<a class="sourceLine" id="cb12-40" data-line-number="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-41" data-line-number="41"><span class="co">#&gt; $Cor</span></a>
<a class="sourceLine" id="cb12-42" data-line-number="42"><span class="co">#&gt; [1] 0.9854043</span></a>
<a class="sourceLine" id="cb12-43" data-line-number="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-44" data-line-number="44"><span class="co">#&gt; $RMSD</span></a>
<a class="sourceLine" id="cb12-45" data-line-number="45"><span class="co">#&gt; [1] 0.05298397</span></a></code></pre></div>
<hr />
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Jorjani, H., Klie. L., &amp; Emanuelson, U. (2000). A simple method for weighted bending of genetic (co)variance matrices. <em>J. Dairy Sci.</em> 86(2): 677â€“679. <a href="https://doi.org/10.3168/jds.S0022-0302(03)73646-7" class="uri">https://doi.org/10.3168/jds.S0022-0302(03)73646-7</a></p>
<p>Schaeffer, L. R. (2014). Making covariance matrices positive definite. Available at: <a href="http://animalbiosciences.uoguelph.ca/~lrs/ELARES/PDforce.pdf" class="uri">http://animalbiosciences.uoguelph.ca/~lrs/ELARES/PDforce.pdf</a></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
